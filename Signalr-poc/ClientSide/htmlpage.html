<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>RadinhoZika</title>
    <style>
        div {
            margin: 10px;
        }
    </style>
</head>
<body>
    <div>
        <input type="text" id="username" size="40" />
        <button type="button" class="" onclick="createUser();">Cadastrar</button>
    </div>
    <div>
        <input type="text" id="roomname" size="40" />
        <button type="button" class="" onclick="createRoom();">Criar Sala</button>
    </div>
    <div class="rooms">

    </div>
    
    <script src="Lib/signalr.js" type="text/javascript"></script>
    <script type="text/javascript">
        //https://localhost:7197
        
        let i = 1;
        
        var hubConnection = new signalR.HubConnectionBuilder().withUrl("https://localhost:7197/hub").build();
        hubConnection.start();

        function createUser() {
            var username = document.querySelector("#username").value;
            hubConnection.invoke("CreateUser", username);
        }

        function createRoom() {
            var roomname = document.querySelector("#roomname").value;
            hubConnection.invoke("CreateRoom", roomname);
            displayRoom(roomname);
        }
        
        function displayRoom(roomname) {
            var room = document.createElement('h2');
            room.textContent = roomname;
            document.querySelector(".rooms").appendChild(room);
            var button = document.createElement('button');
            button.type= "button";
            button.textContent = 'JoinRoom';
            button.onclick = function() {joinRoom(roomname)};
            document.querySelector(".rooms").appendChild(button);
        }

        function joinRoom(roomname){
            console.log("AAAAAAAAAAAAAAAAAAAAAAAAA");
            hubConnection.invoke("JoinRoom",roomname);
        }

        hubConnection.on("RoomCreated", (data) => {
            console.log("Sala " + data + " criada!!!!");
        })

        hubConnection.on("UserCreated", (data) => {
            console.log("O usuário " + data + " foi cadastrado!!!");
        })

        hubConnection.on("UserJoinedRoom", (data) => {
            console.log(data);
        })
    </script>
</body>
</html>